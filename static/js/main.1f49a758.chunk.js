(this["webpackJsonpbundleviewer.octoprint.org"]=this["webpackJsonpbundleviewer.octoprint.org"]||[]).push([[0],{81:function(e,t,n){"use strict";n.r(t);var r=n(3),a=n(0),c=n(14),o=n.n(c),i=n(24),s=n(111),l=n(109),u=n(13),p=n(52),d=n(112),h=n(113),j=n(121),f=n(122),b=n(114),g=n(115),x=n(117),m=n(116),O=n(120),v=n(118),w=n(119),y=n(42),k=n.n(y),N=n(51),R=n.n(N);function C(e){var t=e.info.split("\n").filter((function(e){return""!==e.trim()})).map((function(e){var t=e.split(":",2),n=Object(i.a)(t,2);return{key:n[0],value:n[1]}}));return console.log(t),Object(r.jsx)("div",{children:t.map((function(e,t){return Object(r.jsxs)("div",{children:[Object(r.jsx)("strong",{children:e.key}),": ",e.value,Object(r.jsx)("br",{})]})}))})}var I=n(53),S=Object(l.a)((function(e){return{log:{flexGrow:1,overflow:"auto",padding:0,"font-family":"'JetBrains Mono', 'Droid Sans Mono', monospace"},linenumber:{display:"inline-block",width:"5em","text-align":"right","margin-right":"1em",color:e.palette.text.secondary},line:{}}}));function E(e){var t=S(),n=e.content.split("\n");return Object(r.jsx)("code",{className:t.log,children:Object(r.jsx)("pre",{children:Object(r.jsx)(I.a,{height:500,itemCount:n.length,itemSize:20,children:function(e){var a=e.index,c=e.style;return Object(r.jsxs)("span",{style:c,children:[Object(r.jsx)("span",{className:t.linenumber,children:a+1}),Object(r.jsx)("span",{className:t.line,children:n[a]})]})}})})})}var _=n(17),L=n.n(_),B=n(29),F=n(49),G=n.n(F);function U(e){return Z.apply(this,arguments)}function Z(){return(Z=Object(B.a)(L.a.mark((function e(t){var n;return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t,{mode:"cors"});case 2:if(n=e.sent,console.log(n),n.ok){e.next=6;break}throw new Error("Could not load file from ".concat(t,": ").concat(n.status));case 6:return e.next=8,n.blob();case 8:return e.abrupt("return",e.sent);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function z(){return(z=Object(B.a)(L.a.mark((function e(t){var n;return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,U(t);case 2:return n=e.sent,e.next=5,G.a.loadAsync(n);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function A(){return(A=Object(B.a)(L.a.mark((function e(t,n){return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.file(n);case 2:return e.t0=e.sent,e.abrupt("return",null!==e.t0);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function J(){return(J=Object(B.a)(L.a.mark((function e(t,n,r){return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=r||"arraybuffer",e.next=3,t.file(n).async(r);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var P={loadRemote:U,loadRemoteZip:function(e){return z.apply(this,arguments)},containsFile:function(e,t){return A.apply(this,arguments)},getFileContents:function(e,t,n){return J.apply(this,arguments)}},D=Object(l.a)((function(e){return{root:{display:"flex",overflow:"auto"},grow:{flexGrow:1},offset:e.mixins.toolbar,content:{flexGrow:1,height:"calc(100vh + ".concat(e.mixins.toolbar,"px)"),overflow:"auto"},container:{paddingTop:e.spacing(4),paddingBottom:e.spacing(4)},url:{position:"relative",borderRadius:e.shape.borderRadius,backgroundColor:Object(u.b)(e.palette.common.white,.15),"&:hover":{backgroundColor:Object(u.b)(e.palette.common.white,.25)},marginRight:e.spacing(2),marginLeft:e.spacing(2),flexGrow:1},urlIcon:{padding:e.spacing(0,2),height:"100%",position:"absolute",pointerEvents:"none",display:"flex",alignItems:"center",justifyContent:"center"},inputRoot:{color:"inherit",width:"100%"},inputInput:{padding:e.spacing(1,1,1,0),paddingLeft:"calc(1em + ".concat(e.spacing(4),"px)"),transition:e.transitions.create("width"),width:"100%"}}})),M=/^https:\/\/github\.com\/[a-zA-Z0-9_-]+\/[a-zA-Z0-9_-]+\/files\//;function V(e){var t=Object(s.a)("(prefers-color-scheme: dark)"),n=Object(a.useState)(t),c=Object(i.a)(n,2),o=c[0],l=c[1],u=o?"dark":"light",y=Object(p.a)({palette:{type:u}}),N=e.url,I=D(),S=Object(a.useState)(""),_=Object(i.a)(S,2),L=_[0],B=_[1],F=Object(a.useState)([]),G=Object(i.a)(F,2),U=G[0],Z=G[1];return Object(a.useEffect)((function(){if(e.url){var t=e.url;t.match(M)&&(t=t.replace("https://github.com","https://bundleviewer.octoprint.org/bundles")),P.loadRemoteZip(t).then((function(e){var t=["octoprint.log","serial.log","terminal.txt","plugin_softwareupdate_console.log","plugin_pluginmanager_console.log"];P.getFileContents(e,"systeminfo.txt","string").then((function(e){B(e)}));var n=[],r={};t.forEach((function(t){var a=P.getFileContents(e,t,"string").then((function(e){r[t]=e}));n.push(a)})),Promise.allSettled(n).then((function(){var e=[];t.forEach((function(t){r[t]&&e.push({log:t,content:r[t]})})),Z(e)}))})).catch((function(){}))}}),[e.url]),Object(r.jsx)(d.a,{theme:y,children:Object(r.jsxs)("div",{className:I.root,children:[Object(r.jsx)(h.a,{}),Object(r.jsx)(b.a,{position:"fixed",className:I.appBar,children:Object(r.jsxs)(g.a,{children:[Object(r.jsx)(m.a,{variant:"h6",noWrap:!0,children:"OctoPrint Bundle Viewer"}),Object(r.jsxs)("div",{className:I.url,children:[Object(r.jsx)("div",{className:I.urlIcon,children:Object(r.jsx)(R.a,{})}),Object(r.jsx)(j.a,{placeholder:"URL...",classes:{root:I.inputRoot,input:I.inputInput},onChange:function(e){N=e.target.value},onKeyDown:function(e){"Enter"===e.key&&(window.location.search="?url="+encodeURIComponent(N))},defaultValue:N})]}),Object(r.jsx)(f.a,{checked:o,onChange:function(){l(!o)}})]})}),Object(r.jsxs)("main",{className:I.content,children:[Object(r.jsx)("div",{className:I.offset}),Object(r.jsxs)(x.a,{maxWidth:"lg",className:I.container,children:[Object(r.jsxs)(O.a,{defaultExpanded:!0,children:[Object(r.jsx)(v.a,{expandIcon:Object(r.jsx)(k.a,{}),"aria-controls":"panel-sysinfo-content",id:"panel-sysinfo-header",children:Object(r.jsx)(m.a,{className:I.heading,children:"System Information"})}),Object(r.jsx)(w.a,{children:Object(r.jsx)(C,{info:L})})]}),U.map((function(e,t){return Object(r.jsxs)(O.a,{children:[Object(r.jsx)(v.a,{expandIcon:Object(r.jsx)(k.a,{}),"aria-controls":"panel-log-"+t+"-content",id:"panel-log-"+t+"-header",children:Object(r.jsx)(m.a,{className:I.heading,children:e.log})}),Object(r.jsx)(w.a,{children:Object(r.jsx)(E,{log:e.log,content:e.content,language:"plain"})})]})}))]})]})]})})}var W=window.location.search,q=new URLSearchParams(W).get("url","");console.log("URL",q),o.a.render(Object(r.jsx)(V,{url:null==q?"":q}),document.querySelector("#root"))}},[[81,1,2]]]);
//# sourceMappingURL=main.1f49a758.chunk.js.map