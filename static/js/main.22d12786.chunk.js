(this["webpackJsonpbundleviewer.octoprint.org"]=this["webpackJsonpbundleviewer.octoprint.org"]||[]).push([[0],{82:function(e,t,n){"use strict";n.r(t);var r=n(2),a=n(0),c=n(15),o=n.n(c),i=n(12),s=n(117),l=n(111),u=n(53),j=n(118),p=n(119),d=n(125),b=n(120),f=n(121),h=n(122),x=n(115),O=n(14),g=n(124),m=n(50),v=n.n(m),y=Object(l.a)((function(e){return{grow:{flexGrow:1},url:{position:"relative",borderRadius:e.shape.borderRadius,backgroundColor:Object(O.b)(e.palette.common.white,.15),"&:hover":{backgroundColor:Object(O.b)(e.palette.common.white,.25)},marginRight:e.spacing(2),marginLeft:e.spacing(2),flexGrow:1},urlIcon:{padding:e.spacing(0,2),height:"100%",position:"absolute",pointerEvents:"none",display:"flex",alignItems:"center",justifyContent:"center"},inputRoot:{color:"inherit",width:"100%"},inputInput:{padding:e.spacing(1,1,1,0),paddingLeft:"calc(1em + ".concat(e.spacing(4),"px)"),transition:e.transitions.create("width"),width:"100%"}}}));function w(e){var t=y(),n=Object(a.useState)(e.url),c=Object(i.a)(n,2),o=c[0],s=c[1];return Object(r.jsxs)("div",{className:t.url,children:[Object(r.jsx)("div",{className:t.urlIcon,children:Object(r.jsx)(v.a,{})}),Object(r.jsx)(g.a,{placeholder:"URL...",classes:{root:t.inputRoot,input:t.inputInput},onChange:function(e){s(e.target.value)},onKeyDown:function(t){"Enter"===t.key&&e.handleUrlChange(o)},defaultValue:e.url})]})}var k=n(123),C=n(114),S=n(116),N=n(43),R=n.n(N),E=n(113),I=n(54),L=Object(l.a)((function(e){return{log:{flexGrow:1,overflow:"auto",padding:0,"font-family":"'JetBrains Mono', 'Droid Sans Mono', monospace"},linenumber:{display:"inline-block",width:"5em","text-align":"right","margin-right":"1em",color:e.palette.text.secondary},line:{}}}));function U(e){var t=L(),n=e.content.split("\n");return Object(r.jsx)("code",{className:t.log,children:Object(r.jsx)("pre",{children:Object(r.jsx)(I.a,{height:500,itemCount:n.length,itemSize:20,children:function(e){var a=e.index,c=e.style;return Object(r.jsxs)("span",{style:c,children:[Object(r.jsx)("span",{className:t.linenumber,children:a+1}),Object(r.jsx)("span",{className:t.line,children:n[a]})]})}})})})}function _(e){var t=e.info.split("\n").filter((function(e){return""!==e.trim()})).map((function(e){var t=e.split(":",2),n=Object(i.a)(t,2);return{key:n[0],value:n[1]}}));return console.log(t),Object(r.jsx)("div",{children:t.map((function(e,t){return Object(r.jsxs)("div",{children:[Object(r.jsx)("strong",{children:e.key}),": ",e.value,Object(r.jsx)("br",{})]})}))})}var G=n(18),B=n.n(G),F=n(29),P=n(52),Z=n.n(P);function z(e){return A.apply(this,arguments)}function A(){return(A=Object(F.a)(B.a.mark((function e(t){var n;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t,{mode:"cors"});case 2:if(n=e.sent,console.log(n),n.ok){e.next=6;break}throw new Error("Could not load file from ".concat(t,": ").concat(n.status));case 6:return e.next=8,n.blob();case 8:return e.abrupt("return",e.sent);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function J(){return(J=Object(F.a)(B.a.mark((function e(t){var n;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,z(t);case 2:return n=e.sent,e.next=5,Z.a.loadAsync(n);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function D(){return(D=Object(F.a)(B.a.mark((function e(t,n){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.file(n);case 2:return e.t0=e.sent,e.abrupt("return",null!==e.t0);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function M(){return(M=Object(F.a)(B.a.mark((function e(t,n,r){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=r||"arraybuffer",e.next=3,t.file(n).async(r);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var V={loadRemote:z,loadRemoteZip:function(e){return J.apply(this,arguments)},containsFile:function(e,t){return D.apply(this,arguments)},getFileContents:function(e,t,n){return M.apply(this,arguments)}},W=Object(l.a)((function(e){return{}}));function q(e){var t=W(),n=Object(a.useState)(!0),c=Object(i.a)(n,2),o=c[0],s=c[1],l=Object(a.useState)(!0),u=Object(i.a)(l,2),j=u[0],p=u[1],d=Object(a.useState)(""),b=Object(i.a)(d,2),f=b[0],h=b[1],O=Object(a.useState)([]),g=Object(i.a)(O,2),m=g[0],v=g[1];Object(a.useEffect)((function(){if(e.url){var t=function(e){return e.match(/^https:\/\/github\.com\/[a-zA-Z0-9_-]+\/[a-zA-Z0-9_-]+\/files\//)?e.replace("https://github.com","https://bundleviewer.octoprint.org/bundles"):e}(e.url);V.loadRemoteZip(t).then((function(e){var t=["octoprint.log","serial.log","terminal.txt","plugin_softwareupdate_console.log","plugin_pluginmanager_console.log"];s(!0),p(!0),V.getFileContents(e,"systeminfo.txt","string").then((function(n){h(n),s(!1);var r=[],a={};t.forEach((function(t){var n=V.getFileContents(e,t,"string").then((function(e){a[t]=e}));r.push(n)})),Promise.allSettled(r).then((function(){var e=[];t.forEach((function(t){a[t]&&e.push({log:t,content:a[t]})})),v(e),p(!1)}))}))})).catch((function(){}))}}),[e.url]);var y=function(){return o?Object(r.jsx)("div",{style:{display:"flex",justifyContent:"center"},children:Object(r.jsx)(E.a,{})}):Object(r.jsxs)(k.a,{defaultExpanded:!0,children:[Object(r.jsx)(C.a,{expandIcon:Object(r.jsx)(R.a,{}),"aria-controls":"panel-sysinfo-content",id:"panel-sysinfo-header",children:Object(r.jsx)(x.a,{className:t.heading,children:"System Information"})}),Object(r.jsx)(S.a,{children:Object(r.jsx)(_,{info:f})})]})},w=function(){return o?null:j?Object(r.jsx)("div",{style:{display:"flex",justifyContent:"center"},children:Object(r.jsx)(E.a,{})}):Object(r.jsx)("div",{children:m.map((function(e,n){return Object(r.jsxs)(k.a,{children:[Object(r.jsx)(C.a,{expandIcon:Object(r.jsx)(R.a,{}),"aria-controls":"panel-log-"+n+"-content",id:"panel-log-"+n+"-header",children:Object(r.jsx)(x.a,{className:t.heading,children:e.log})}),Object(r.jsx)(S.a,{children:Object(r.jsx)(U,{log:e.log,content:e.content,language:"plain"})})]})}))})};return Object(r.jsxs)("div",{children:[Object(r.jsx)(y,{}),Object(r.jsx)(w,{})]})}function K(){return Object(r.jsx)(x.a,{style:{display:"flex",justifyContent:"center"},children:"Please enter a bundle URL and press Enter."})}var T=Object(l.a)((function(e){return{root:{display:"flex",overflow:"auto"},grow:{flexGrow:1},offset:e.mixins.toolbar,content:{flexGrow:1,height:"calc(100vh + ".concat(e.mixins.toolbar,"px)"),overflow:"auto"},container:{paddingTop:e.spacing(4),paddingBottom:e.spacing(4)}}}));function H(e){var t=Object(s.a)("(prefers-color-scheme: dark)"),n=Object(a.useState)(t),c=Object(i.a)(n,2),o=c[0],l=c[1],O=Object(a.useState)(e.url),g=Object(i.a)(O,2),m=g[0],v=g[1],y=o?"dark":"light",k=Object(u.a)({palette:{type:y}}),C=T(),S=function(){return m?Object(r.jsx)(q,{url:m}):Object(r.jsx)(K,{})};return Object(r.jsx)(j.a,{theme:k,children:Object(r.jsxs)("div",{className:C.root,children:[Object(r.jsx)(p.a,{}),Object(r.jsx)(b.a,{position:"fixed",className:C.appBar,children:Object(r.jsxs)(f.a,{children:[Object(r.jsx)(x.a,{variant:"h6",noWrap:!0,children:"OctoPrint Bundle Viewer"}),Object(r.jsx)(w,{url:m,handleUrlChange:function(e){v(e)}}),Object(r.jsx)(d.a,{checked:o,onChange:function(){l(!o)}})]})}),Object(r.jsxs)("main",{className:C.content,children:[Object(r.jsx)("div",{className:C.offset}),Object(r.jsx)(h.a,{maxWidth:"lg",className:C.container,children:Object(r.jsx)(S,{})})]})]})})}var Q=window.location.search,X=new URLSearchParams(Q).get("url","");console.log("URL",X),o.a.render(Object(r.jsx)(H,{url:null==X?"":X}),document.querySelector("#root"))}},[[82,1,2]]]);
//# sourceMappingURL=main.22d12786.chunk.js.map