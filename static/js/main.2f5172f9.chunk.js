(this["webpackJsonpbundleviewer.octoprint.org"]=this["webpackJsonpbundleviewer.octoprint.org"]||[]).push([[0],{174:function(e,n,t){"use strict";t.r(n);var a=t(5),r=t(0),o=t(12),c=t.n(o),i=t(19),l=t(13),s=t(220),d=t(217),u=t(115),p=t(231),j=t(232),b=t(229),g=t(230),f=t(233),h=t(176),x=t(237),O=t(114),m=t.n(O),v=t(113),w=t.n(v),y=t(235),k=t(227),N=t(228),S=t(80),C=t(239),R=t(98),I=t.n(R),z=t(97),B=t.n(z);function G(e){var n=Object(r.useState)(e.darkMode),t=Object(i.a)(n,2),o=t[0],c=t[1];return Object(a.jsx)(C.a,{title:"Toggle dark mode",children:Object(a.jsx)(h.a,{onClick:function(){e.onChange(!o),c(!o)},color:"inherit",children:o?Object(a.jsx)(B.a,{}):Object(a.jsx)(I.a,{})})})}var E=t(11),L=t(240),U=t(99),_=t.n(U),P=t(76),A=t.n(P),F=Object(d.a)((function(e){var n,t;return{grow:{flexGrow:1},url:(n={position:"relative",borderRadius:e.shape.borderRadius,backgroundColor:Object(E.c)(e.palette.common.white,.15),"&:hover":{backgroundColor:Object(E.c)(e.palette.common.white,.25)}},Object(l.a)(n,e.breakpoints.up("md"),{marginRight:e.spacing(2),marginLeft:e.spacing(2)}),Object(l.a)(n,"flexGrow",1),n),urlIcon:{padding:e.spacing(0,2),height:"100%",position:"absolute",pointerEvents:"none",display:"flex",alignItems:"center",justifyContent:"center"},inputRoot:{color:"inherit",width:"100%"},inputInput:(t={padding:e.spacing(1,1,1,1)},Object(l.a)(t,e.breakpoints.up("md"),{paddingLeft:"calc(1em + ".concat(e.spacing(4),"px)")}),Object(l.a)(t,"transition",e.transitions.create("width")),Object(l.a)(t,"width","100%"),t)}}));function D(e){var n=F(),t=Object(r.useState)(e.url),o=Object(i.a)(t,2),c=o[0],l=o[1],s=Object(r.useState)(e.filename?"upload":"url"),d=Object(i.a)(s,1)[0];return Object(a.jsxs)("div",{className:n.url,children:[Object(a.jsx)(x.a,{mdDown:!0,children:Object(a.jsx)("div",{className:n.urlIcon,children:e.filename?Object(a.jsx)(A.a,{}):Object(a.jsx)(_.a,{})})}),Object(a.jsx)(L.a,{placeholder:"URL...",classes:{root:n.inputRoot,input:n.inputInput},onChange:function(e){"url"===d&&l(e.target.value)},onKeyDown:function(n){"url"===d&&"Enter"===n.key&&e.handleUrlChange(c)},defaultValue:"upload"===d?e.filename:e.url,inputProps:{readOnly:"upload"===d}})]})}var T=t(224),H=t(234),W=t(238),Z=t(223),J=t(222),M=t(221),q=t(100),K=t.n(q);function V(e){var n=Object(S.b)().enqueueSnackbar,t=Object(r.useState)(!1),o=Object(i.a)(t,2),c=o[0],l=o[1],s=window.location.origin+window.location.pathname+"?url="+encodeURIComponent(e.url),d=function(){l(!1)};return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(C.a,{title:"Get shareable link",children:Object(a.jsx)(h.a,{onClick:function(){l(!0)},color:"inherit",children:Object(a.jsx)(K.a,{})})}),Object(a.jsxs)(W.a,{open:c,onClose:d,fullWidth:!0,children:[Object(a.jsx)(M.a,{children:"Shareable link"}),Object(a.jsx)(J.a,{children:Object(a.jsx)(H.a,{value:s,InputProps:{readOnly:!0},onFocus:function(e){e.target.select()},fullWidth:!0})}),Object(a.jsxs)(Z.a,{children:[navigator.share?Object(a.jsx)(T.a,{onClick:function(){navigator.share&&(navigator.share({title:document.title,url:s}),d())},children:"Share"}):null,navigator.clipboard?Object(a.jsx)(T.a,{onClick:function(){navigator.clipboard&&(navigator.clipboard.writeText(s),n("URL copied to clipboard!"),d())},children:"Copy"}):null,Object(a.jsx)(T.a,{onClick:d,children:"Close"})]})]})]})}var Q=t(117),X=t(241),Y=t(225),$=t(226),ee=t(79),ne=t.n(ee),te=t(121),ae=t(101),re=t.n(ae),oe=t(87),ce=t.n(oe);function ie(e){var n,t=e.log,r=e.content,o=r.trim().split("\n"),c=o.length,i=Object(d.a)((function(e){return{background:{},log:{flexGrow:1},pre:Object(l.a)({margin:0,"font-family":"'JetBrains Mono', 'Droid Sans Mono', monospace"},e.breakpoints.down("md"),{fontSize:e.typography.pxToRem(12)}),line:{paddingLeft:e.spacing(1),"&::before":{content:"attr(data-linenumber)",display:"inline-block",width:"".concat(c.toString().length,"ch"),"text-align":"right","margin-right":"1em",color:e.palette.text.disabled},'&[data-loglevel="DEBUG"]':{color:e.palette.text.secondary},'&[data-loglevel="WARNING"]':{color:e.palette.warning.main},'&[data-loglevel="ERROR"]':{color:e.palette.error.main},'&[data-stream="stdin"]':{color:e.palette.info.main},'&[data-stream="stderr"]':{color:e.palette.error.main}},accordionbar:Object(l.a)({display:"flex",flexGrow:1,alignItems:"center"},e.breakpoints.down("md"),{flexWrap:"wrap"}),grow:{flexGrow:1},icon:{padding:e.spacing(0,1),fontSize:"1.5rem"},secondaryHeading:Object(l.a)({fontSize:e.typography.pxToRem(12),color:e.palette.text.secondary,padding:e.spacing(0,1),textAlign:"right"},e.breakpoints.down("md"),{textAlign:"left",padding:e.spacing(0,0)}),title:Object(l.a)({flexGrow:1,alignItems:"center"},e.breakpoints.down("md"),{flexBasis:"100%"}),info:Object(l.a)({},e.breakpoints.down("md"),{flexBasis:"100%"})}}))(),s=function(e){switch(e.charAt(24)){case" ":return"stdin";case">":return"stdout";case"!":return"stderr";default:return"plain"}};switch(e.language){case"log":n=function(e){var n,t=e.index,r=e.style;return Object(a.jsx)("span",{style:r,children:Object(a.jsx)("span",{"data-linenumber":t+1,"data-loglevel":(n=o[t],n.split(" ")[5]),className:i.line,children:o[t]})})};break;case"cli":n=function(e){var n=e.index,t=e.style;return Object(a.jsx)("span",{style:t,children:Object(a.jsx)("span",{"data-linenumber":n+1,"data-stream":s(o[n]),className:i.line,children:o[n]})})};break;default:n=function(e){var n=e.index,t=e.style;return Object(a.jsx)("span",{style:t,children:Object(a.jsx)("span",{"data-linenumber":n+1,className:i.line,children:o[n]})})}}var u="serial.log"===t&&1===c&&o[0].includes("serial.log is currently not enabled");return Object(a.jsxs)(X.a,{children:[Object(a.jsx)(Y.a,{expandIcon:Object(a.jsx)(ne.a,{}),"aria-controls":"panel-log-"+e.index+"-content",id:"panel-log-"+e.index+"-header",children:Object(a.jsxs)("div",{className:i.accordionbar,children:[Object(a.jsx)("div",{className:i.title,children:Object(a.jsxs)(te.a,{className:i.heading,style:{display:"flex",alignItems:"center"},children:[t,u?Object(a.jsx)(re.a,{className:i.icon,size:"1.5em"}):null]})}),Object(a.jsxs)("div",{className:i.info,children:[Object(a.jsx)(te.a,{className:i.secondaryHeading,children:ce()(r.length)+" "+(1===r.length?"char":"chars")}),Object(a.jsx)(te.a,{className:i.secondaryHeading,children:ce()(c)+" "+(1===c?"line":"lines")})]})]})}),Object(a.jsx)($.a,{children:Object(a.jsx)("code",{className:i.log,children:Object(a.jsx)("pre",{className:i.pre,children:Object(a.jsx)(Q.a,{height:500,itemCount:c,itemSize:20,style:{overflow:"scroll"},children:n})})})})]},t)}var le=t(102),se=t(118),de=t(103),ue=t.n(de),pe=Object(d.a)((function(e){return{accordionbar:Object(l.a)({display:"flex",flexGrow:1,alignItems:"center"},e.breakpoints.down("md"),{flexWrap:"wrap"}),grow:{flexGrow:1},icon:{padding:e.spacing(0,1),fontSize:"1.5rem"},secondaryHeading:Object(l.a)({fontSize:e.typography.pxToRem(12),color:e.palette.text.secondary,padding:e.spacing(0,1),textAlign:"right"},e.breakpoints.down("md"),{textAlign:"left",padding:e.spacing(0,0)}),title:Object(l.a)({flexGrow:1,alignItems:"center"},e.breakpoints.down("md"),{flexBasis:"100%"}),info:Object(l.a)({},e.breakpoints.down("md"),{flexBasis:"100%"})}}));function je(e){var n,t=e.info.split("\n").filter((function(e){return""!==e.trim()})).map((function(e){var n=e.split(":"),t=Object(se.a)(n);return{key:t[0],value:t.slice(1)}})),r={},o=Object(le.a)(t);try{for(o.s();!(n=o.n()).done;){var c=n.value;r[c.key]=c.value}}catch(s){o.e(s)}finally{o.f()}var i=pe(),l=function(e,n){var t=r[n];return t?Object(a.jsx)(te.a,{className:i.secondaryHeading,children:e+" "+t}):null};return Object(a.jsxs)(X.a,{defaultExpanded:!0,children:[Object(a.jsx)(Y.a,{expandIcon:Object(a.jsx)(ne.a,{}),"aria-controls":"panel-sysinfo-content",id:"panel-sysinfo-header",children:Object(a.jsxs)("div",{className:i.accordionbar,children:[Object(a.jsx)("div",{className:i.title,children:Object(a.jsxs)(te.a,{className:i.heading,style:{display:"flex",alignItems:"center"},children:["System Information",Object(a.jsx)(ue.a,{className:i.icon,size:"1.5em"})]})}),Object(a.jsxs)("div",{className:i.info,children:[l("OctoPrint","octoprint.version"),l("Python","env.python.version"),l("OctoPi","env.plugins.pi_support.octopi_version")]})]})}),Object(a.jsx)($.a,{children:Object(a.jsx)("div",{className:i.list,children:t.map((function(e,n){return Object(a.jsxs)("div",{children:[Object(a.jsx)("strong",{children:e.key}),": ",e.value]},e.key)}))})})]})}function be(e){return Object(a.jsxs)("div",{children:[Object(a.jsx)(je,{info:e.bundle.systeminfo}),Object(a.jsx)("div",{children:e.bundle.logs.map((function(e,n){return Object(a.jsx)(ie,{log:e.log,content:e.content,language:e.language,index:n})}))})]})}var ge=t(116);function fe(e){console.log("Rendering NothingChanged...");return Object(a.jsx)("div",{style:{display:"flex",justifyContent:"center",flexDirection:"column"},children:Object(a.jsx)(ge.a,{style:{"flex-basis":"100%"},dropzoneText:"Enter an URL for a bundle above and press Enter, or drag and drop a file here or click to upload one",onChange:function(n){console.log("Entered NothingLoaded.handleChange..."),n.length>0&&e.onUpload(n[0]),console.log("Exiting NothingLoaded.handleChange...")},filesLimit:1,acceptedFiles:[".zip"],maxFileSize:3e7,showPreviewsInDropzone:!1,showAlerts:!1})})}var he=t(24),xe=t.n(he),Oe=t(41),me=t(112),ve=t.n(me);function we(e){return ye.apply(this,arguments)}function ye(){return(ye=Object(Oe.a)(xe.a.mark((function e(n){var t;return xe.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(n,{mode:"cors"});case 2:if(t=e.sent,console.log(t),t.ok){e.next=6;break}throw new Error("Could not load file from ".concat(n,": ").concat(t.status));case 6:return e.next=8,t.blob();case 8:return e.abrupt("return",e.sent);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ke(){return(ke=Object(Oe.a)(xe.a.mark((function e(n){var t;return xe.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,we(n);case 2:return t=e.sent,e.next=5,Ne(t);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ne(e){return Se.apply(this,arguments)}function Se(){return(Se=Object(Oe.a)(xe.a.mark((function e(n){return xe.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,ve.a.loadAsync(n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Ce(){return(Ce=Object(Oe.a)(xe.a.mark((function e(n,t){return xe.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.file(t);case 2:return e.t0=e.sent,e.abrupt("return",null!==e.t0);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Re(){return(Re=Object(Oe.a)(xe.a.mark((function e(n,t,a){return xe.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=a||"blob",e.next=3,n.file(t).async(a);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var Ie={loadRemote:we,loadZip:Ne,loadRemoteZip:function(e){return ke.apply(this,arguments)},containsFile:function(e,n){return Ce.apply(this,arguments)},getFileContents:function(e,n,t){return Re.apply(this,arguments)}},ze={"octoprint.log":"log","plugin_softwareupdate_console.log":"cli","plugin_pluginmanager_console.log":"cli"};function Be(){return(Be=Object(Oe.a)(xe.a.mark((function e(n){var t,a,r,o,c,i,l,s,d,u,p;return xe.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=["octoprint.log","serial.log","terminal.txt","plugin_softwareupdate_console.log","plugin_pluginmanager_console.log"],e.next=3,Ie.getFileContents(n,"systeminfo.txt","string");case 3:if(a=e.sent){e.next=6;break}throw new Error("No systeminfo.txt found");case 6:r={},o=0,c=t;case 8:if(!(o<c.length)){e.next=22;break}return i=c[o],e.prev=10,e.next=13,Ie.getFileContents(n,i,"string");case 13:r[i]=e.sent,e.next=19;break;case 16:e.prev=16,e.t0=e.catch(10),console.log("No ".concat(i," in zip..."));case 19:o++,e.next=8;break;case 22:for(l=[],s=0,d=t;s<d.length;s++)u=d[s],r[u]&&(p=ze[u]||"plain",l.push({log:u,content:r[u],language:p}));return e.abrupt("return",{systeminfo:a,logs:l});case 25:case"end":return e.stop()}}),e,null,[[10,16]])})))).apply(this,arguments)}var Ge={loadBundle:function(e){return Be.apply(this,arguments)},defaultBundle:{systeminfo:"",logs:[]}},Ee=Object(d.a)((function(e){var n;return{root:{display:"flex",overflow:"auto"},grow:{flexGrow:1},appBar:{},toolbar:Object(l.a)({},e.breakpoints.down("md"),{"justify-content":"flex-end","flex-wrap":"wrap"}),urlbar:Object(l.a)({flexGrow:1},e.breakpoints.down("md"),{"flex-basis":"100%",order:99,paddingBottom:e.spacing(2)}),title:{"justify-item":"left"},offset:e.mixins.toolbar,content:Object(l.a)({flexGrow:1,overflow:"auto","padding-top":e.mixins.toolbar.minHeight},e.breakpoints.down("md"),{"padding-top":2*e.mixins.toolbar.minHeight}),container:(n={paddingTop:e.spacing(4)},Object(l.a)(n,e.breakpoints.down("md"),{paddingTop:0}),Object(l.a)(n,"paddingBottom",e.spacing(4)),n)}}));function Le(e){var n=function(e,n){var t=Object(r.useState)((function(){try{var t=window.localStorage.getItem(e);return t?JSON.parse(t):n}catch(A){return console.log(A),n}})),a=Object(i.a)(t,2),o=a[0],c=a[1];return[o,function(n){try{var t=n instanceof Function?n(o):n;c(t),window.localStorage.setItem(e,JSON.stringify(t))}catch(A){console.log(A)}}]}("enableDarkMode",Object(s.a)("(prefers-color-scheme: dark)")),t=Object(i.a)(n,2),o=t[0],c=t[1],l=Object(r.useState)(e.url),d=Object(i.a)(l,2),O=d[0],v=d[1],C=Object(r.useState)(""),R=Object(i.a)(C,2),I=R[0],z=R[1],B=Object(r.useState)(Ge.defaultBundle),E=Object(i.a)(B,2),L=E[0],U=E[1],_=Object(r.useState)(!1),P=Object(i.a)(_,2),A=P[0],F=P[1],T=Object(r.useState)(!1),H=Object(i.a)(T,2),W=H[0],Z=H[1],J=o?"dark":"light",M=Object(u.a)({palette:{type:J}}),q=function(){c(!o)};Object(r.useEffect)((function(){K(e.url)}),[]);var K=function(e){if(e){F(!1),Z(!0),v(e),ee(e),z("");var n=function(e){return e.match(/^https:\/\/github\.com\/[a-zA-Z0-9_-]+\/[a-zA-Z0-9_-]+\/files\//)?e.replace("https://github.com","https://bundleviewer.octoprint.org/bundles"):e}(e);Ie.loadRemoteZip(n).then(X).catch(Y)}else $()},Q=function(e){F(!1),Z(!0),z(e.name),v(""),Ie.loadZip(e).then(X).catch(Y)},X=function(e){Ge.loadBundle(e).then((function(e){U(e),Z(!1),console.log("Loading complete")})).catch(Y)},Y=function(e){console.log(e),F(!0)},$=function(){v(""),z(""),F(!1),Z(!1),U(Ge.defaultBundle),ee()},ee=function(e){var n=new URL(window.location);e?n.searchParams.set("url",e):n.searchParams.delete("url"),window.history.replaceState({},"",n)},ne=Ee(),te=function(){return A?(console.log("Rendering error screen"),Object(a.jsxs)(y.a,{severity:"error",children:[Object(a.jsx)(k.a,{children:"Error"}),"Could not load bundle, is it accessible and an OctoPrint SystemInfo Bundle zipfile?"]})):W?(console.log("Rendering loading screen"),Object(a.jsx)("div",{style:{display:"flex",justifyContent:"center"},children:Object(a.jsx)(N.a,{})})):L.systeminfo?(console.log("Rendering bundle"),Object(a.jsx)(be,{bundle:L})):(console.log("Rendering empty"),Object(a.jsx)(fe,{onUpload:Q}))},ae=function(){return Object(a.jsx)(b.a,{className:ne.appBar,children:Object(a.jsxs)(g.a,{className:ne.toolbar,children:[Object(a.jsx)(h.a,{onClick:$,color:"inherit",children:Object(a.jsx)(w.a,{})}),Object(a.jsx)(x.a,{mdUp:!0,children:Object(a.jsx)("div",{className:ne.grow})}),Object(a.jsx)("div",{className:ne.urlbar,children:Object(a.jsx)(D,{url:O,filename:I,handleUrlChange:K})}),O?Object(a.jsx)(V,{url:O}):null,Object(a.jsx)(G,{darkMode:o,onChange:q}),Object(a.jsx)(x.a,{xsDown:!0,children:Object(a.jsx)(h.a,{href:"https://github.com/OctoPrint/bundleviewer.octoprint.org",target:"_blank",color:"inherit",children:Object(a.jsx)(m.a,{})})})]})})};return Object(a.jsx)(p.a,{theme:M,children:Object(a.jsx)(S.a,{children:Object(a.jsxs)("div",{className:ne.root,style:{display:"flex"},children:[Object(a.jsx)(j.a,{}),Object(a.jsx)(ae,{}),Object(a.jsx)("main",{className:ne.content,children:Object(a.jsx)(f.a,{maxWidth:"lg",className:ne.container,children:Object(a.jsx)(te,{})})})]})})})}var Ue=window.location.search,_e=new URLSearchParams(Ue).get("url","");console.log("URL",_e),c.a.render(Object(a.jsx)(Le,{url:null==_e?"":_e}),document.querySelector("#root"))}},[[174,1,2]]]);
//# sourceMappingURL=main.2f5172f9.chunk.js.map