(this["webpackJsonpbundleviewer.octoprint.org"]=this["webpackJsonpbundleviewer.octoprint.org"]||[]).push([[0],{83:function(e,t,n){"use strict";n.r(t);var r=n(2),c=n(0),a=n(15),o=n.n(a),i=n(9),s=n(118),l=n(113),u=n(54),j=n(119),d=n(120),p=n(121),b=n(122),f=n(123),h=n(116),x=n(126),O=n(50),g=n.n(O);function m(e){var t=Object(c.useState)(e.darkMode),n=Object(i.a)(t,2),a=n[0],o=n[1];return Object(r.jsxs)("div",{style:{display:"flex",alignItems:"center"},children:[Object(r.jsx)(g.a,{}),Object(r.jsx)(x.a,{checked:a,onChange:function(){e.onChange(!a),o(!a)}})]})}var v=n(14),y=n(125),w=n(52),k=n.n(w),S=Object(l.a)((function(e){return{grow:{flexGrow:1},url:{position:"relative",borderRadius:e.shape.borderRadius,backgroundColor:Object(v.b)(e.palette.common.white,.15),"&:hover":{backgroundColor:Object(v.b)(e.palette.common.white,.25)},marginRight:e.spacing(2),marginLeft:e.spacing(2),flexGrow:1},urlIcon:{padding:e.spacing(0,2),height:"100%",position:"absolute",pointerEvents:"none",display:"flex",alignItems:"center",justifyContent:"center"},inputRoot:{color:"inherit",width:"100%"},inputInput:{padding:e.spacing(1,1,1,0),paddingLeft:"calc(1em + ".concat(e.spacing(4),"px)"),transition:e.transitions.create("width"),width:"100%"}}}));function C(e){var t=S(),n=Object(c.useState)(e.url),a=Object(i.a)(n,2),o=a[0],s=a[1];return Object(r.jsxs)("div",{className:t.url,children:[Object(r.jsx)("div",{className:t.urlIcon,children:Object(r.jsx)(k.a,{})}),Object(r.jsx)(y.a,{placeholder:"URL...",classes:{root:t.inputRoot,input:t.inputInput},onChange:function(e){s(e.target.value)},onKeyDown:function(t){"Enter"===t.key&&e.handleUrlChange(o)},defaultValue:e.url})]})}var R=n(124),N=n(115),I=n(117),E=n(46),L=n.n(E),U=n(114),_=n(55);function F(e){var t=e.content.split("\n"),n=t.length,c=Object(l.a)((function(e){return{log:{flexGrow:1,overflow:"auto",padding:0,"font-family":"'JetBrains Mono', 'Droid Sans Mono', monospace"},linenumber:{display:"inline-block",width:"".concat(n.toString().length,"ch"),"text-align":"right","margin-right":"1em",color:e.palette.text.secondary},line:{}}}))();return Object(r.jsx)("code",{className:c.log,children:Object(r.jsx)("pre",{children:Object(r.jsx)(_.a,{height:500,itemCount:n,itemSize:20,children:function(e){var n=e.index,a=e.style;return Object(r.jsxs)("span",{style:a,children:[Object(r.jsx)("span",{className:c.linenumber,children:n+1}),Object(r.jsx)("span",{className:c.line,children:t[n]})]})}})})})}function G(e){var t=e.info.split("\n").filter((function(e){return""!==e.trim()})).map((function(e){var t=e.split(":",2),n=Object(i.a)(t,2);return{key:n[0],value:n[1]}}));return console.log(t),Object(r.jsx)("div",{children:t.map((function(e,t){return Object(r.jsxs)("div",{children:[Object(r.jsx)("strong",{children:e.key}),": ",e.value,Object(r.jsx)("br",{})]},e.key)}))})}var J=n(18),M=n.n(J),B=n(29),P=n(53),Z=n.n(P);function z(e){return A.apply(this,arguments)}function A(){return(A=Object(B.a)(M.a.mark((function e(t){var n;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t,{mode:"cors"});case 2:if(n=e.sent,console.log(n),n.ok){e.next=6;break}throw new Error("Could not load file from ".concat(t,": ").concat(n.status));case 6:return e.next=8,n.blob();case 8:return e.abrupt("return",e.sent);case 9:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function D(){return(D=Object(B.a)(M.a.mark((function e(t){var n;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,z(t);case 2:return n=e.sent,e.next=5,Z.a.loadAsync(n);case 5:return e.abrupt("return",e.sent);case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function V(){return(V=Object(B.a)(M.a.mark((function e(t,n){return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.file(n);case 2:return e.t0=e.sent,e.abrupt("return",null!==e.t0);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function W(){return(W=Object(B.a)(M.a.mark((function e(t,n,r){return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=r||"arraybuffer",e.next=3,t.file(n).async(r);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var q={loadRemote:z,loadRemoteZip:function(e){return D.apply(this,arguments)},containsFile:function(e,t){return V.apply(this,arguments)},getFileContents:function(e,t,n){return W.apply(this,arguments)}},K=Object(l.a)((function(e){return{}}));function T(e){var t=K(),n=Object(c.useState)(!0),a=Object(i.a)(n,2),o=a[0],s=a[1],l=Object(c.useState)(!0),u=Object(i.a)(l,2),j=u[0],d=u[1],p=Object(c.useState)(""),b=Object(i.a)(p,2),f=b[0],x=b[1],O=Object(c.useState)([]),g=Object(i.a)(O,2),m=g[0],v=g[1],y=Object(c.useRef)();Object(c.useEffect)((function(){if(e.url){if(console.log("loadedURL",y.current),e.url===y.current)return void console.log("Same URL");var t=function(e){return e.match(/^https:\/\/github\.com\/[a-zA-Z0-9_-]+\/[a-zA-Z0-9_-]+\/files\//)?e.replace("https://github.com","https://bundleviewer.octoprint.org/bundles"):e}(e.url);s(!0),d(!0),q.loadRemoteZip(t).then((function(e){y.current=t;var n=["octoprint.log","serial.log","terminal.txt","plugin_softwareupdate_console.log","plugin_pluginmanager_console.log"];q.getFileContents(e,"systeminfo.txt","string").then((function(t){x(t),s(!1);var r=[],c={};n.forEach((function(t){var n=q.getFileContents(e,t,"string").then((function(e){c[t]=e}));r.push(n)})),Promise.allSettled(r).then((function(){var e=[];n.forEach((function(t){c[t]&&e.push({log:t,content:c[t]})})),v(e),d(!1)}))}))})).catch((function(){}))}}),[e.url]);var w=function(){return o?Object(r.jsx)("div",{style:{display:"flex",justifyContent:"center"},children:Object(r.jsx)(U.a,{})}):Object(r.jsxs)(R.a,{defaultExpanded:!0,children:[Object(r.jsx)(N.a,{expandIcon:Object(r.jsx)(L.a,{}),"aria-controls":"panel-sysinfo-content",id:"panel-sysinfo-header",children:Object(r.jsx)(h.a,{className:t.heading,children:"System Information"})}),Object(r.jsx)(I.a,{children:Object(r.jsx)(G,{info:f})})]})},k=function(){return o?null:j?Object(r.jsx)("div",{style:{display:"flex",justifyContent:"center"},children:Object(r.jsx)(U.a,{})}):Object(r.jsx)("div",{children:m.map((function(e,n){return Object(r.jsxs)(R.a,{children:[Object(r.jsx)(N.a,{expandIcon:Object(r.jsx)(L.a,{}),"aria-controls":"panel-log-"+n+"-content",id:"panel-log-"+n+"-header",children:Object(r.jsx)(h.a,{className:t.heading,children:e.log})}),Object(r.jsx)(I.a,{children:Object(r.jsx)(F,{log:e.log,content:e.content,language:"plain"})})]},e.log)}))})};return Object(r.jsxs)("div",{children:[Object(r.jsx)(w,{}),Object(r.jsx)(k,{})]})}function H(){return Object(r.jsx)(h.a,{style:{display:"flex",justifyContent:"center"},children:"Please enter a bundle URL and press Enter."})}var Q=Object(l.a)((function(e){return{root:{display:"flex",overflow:"auto"},grow:{flexGrow:1},offset:e.mixins.toolbar,content:{flexGrow:1,height:"calc(100vh + ".concat(e.mixins.toolbar,"px)"),overflow:"auto"},container:{paddingTop:e.spacing(4),paddingBottom:e.spacing(4)}}}));function X(e){var t=function(e,t){var n=Object(c.useState)((function(){try{var n=window.localStorage.getItem(e);return n?JSON.parse(n):t}catch(r){return console.log(r),t}})),r=Object(i.a)(n,2),a=r[0],o=r[1];return[a,function(t){try{var n=t instanceof Function?t(a):t;o(n),window.localStorage.setItem(e,JSON.stringify(n))}catch(r){console.log(r)}}]}("enableDarkMode",Object(s.a)("(prefers-color-scheme: dark)")),n=Object(i.a)(t,2),a=n[0],o=n[1],l=Object(c.useState)(e.url),x=Object(i.a)(l,2),O=x[0],g=x[1],v=a?"dark":"light",y=Object(u.a)({palette:{type:v}}),w=Q(),k=function(){return O?Object(r.jsx)(T,{url:O}):Object(r.jsx)(H,{})};return Object(r.jsx)(j.a,{theme:y,children:Object(r.jsxs)("div",{className:w.root,children:[Object(r.jsx)(d.a,{}),Object(r.jsx)(p.a,{position:"fixed",className:w.appBar,children:Object(r.jsxs)(b.a,{children:[Object(r.jsx)(h.a,{variant:"h6",noWrap:!0,children:"OctoPrint Bundle Viewer"}),Object(r.jsx)(C,{url:O,handleUrlChange:function(e){g(e)}}),Object(r.jsx)(m,{darkMode:a,onChange:function(){o(!a)}})]})}),Object(r.jsxs)("main",{className:w.content,children:[Object(r.jsx)("div",{className:w.offset}),Object(r.jsx)(f.a,{maxWidth:"lg",className:w.container,children:Object(r.jsx)(k,{})})]})]})})}var Y=window.location.search,$=new URLSearchParams(Y).get("url","");console.log("URL",$),o.a.render(Object(r.jsx)(X,{url:null==$?"":$}),document.querySelector("#root"))}},[[83,1,2]]]);
//# sourceMappingURL=main.da54c6e4.chunk.js.map